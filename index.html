<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <title>CV ‚Äì Nicolas Parisse</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
  <meta name="description" content="CV de Nicolas Parisse, QA Automation Engineer sp√©cialis√© en Cypress, tests API et int√©gration CI/CD." />

  <style>
    :root {
      --bg: #f6f7fb;
      --bg-card: #ffffff;
      --primary: #3c6fd1;
      --primary-soft: #dbe5ff;
      --accent: #ffb8b8;
      --text-main: #202333;
      --text-soft: #6d7485;
      --chip-bg: #eef0f7;
      --border-soft: #e2e4ee;
      --shadow-soft: 0 14px 35px rgba(15, 35, 52, 0.08);
      --radius-card: 24px;
      --radius-pill: 999px;
    }

    * {
      box-sizing: border-box;
      -webkit-tap-highlight-color: transparent;
    }

    html, body {
      margin: 0;
      padding: 0;
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "SF Pro Text", "Segoe UI", sans-serif;
      background: var(--bg);
      color: var(--text-main);
    }

    body {
      min-height: 100vh;
      display: flex;
      justify-content: center;
    }

    /* Conteneur type "tiktok" centr√©, max 480px */
    .app {
      width: 100%;
      max-width: 480px;
      padding: env(safe-area-inset-top, 16px) 12px env(safe-area-inset-bottom, 16px);
      display: flex;
      flex-direction: column;
      gap: 12px;
    }

    header.app-header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 4px 4px 0;
    }

    .logo-text {
      font-weight: 700;
      letter-spacing: 0.08em;
      font-size: 11px;
      text-transform: uppercase;
      color: var(--text-soft);
    }

    .tag-pill {
      padding: 4px 10px;
      border-radius: var(--radius-pill);
      background: rgba(60, 111, 209, 0.07);
      font-size: 11px;
      color: var(--primary);
      font-weight: 600;
    }

    /* Zone cartes scrollables */
    .feed {
      flex: 1;
      display: flex;
      flex-direction: column;
      gap: 16px;
      padding-bottom: 8px;
    }


    .card {
      background: var(--bg-card);
      border-radius: var(--radius-card);
      box-shadow: var(--shadow-soft);
      padding: 18px 18px 16px;
      position: relative;
      overflow: hidden;
    }

    .card::before {
      content: "";
      position: absolute;
      inset: 0;
      background: radial-gradient(circle at 0 0, rgba(60,111,209,0.12), transparent 60%);
      opacity: 0.7;
      pointer-events: none;
    }

    .card-inner {
      position: relative;
      z-index: 1;
    }

    /* Carte profil (plein √©cran-ish) */
    .card--hero {
      padding-top: 22px;
      padding-bottom: 20px;
    }

    .hero-header {
      display: flex;
      align-items: center;
      gap: 14px;
    }

    .avatar {
      width: 72px;
      height: 72px;
      border-radius: 999px;
      background: linear-gradient(135deg, #c9d6ff, #e2e2ff);
      position: relative;
      overflow: hidden;
      flex-shrink: 0;
      display: flex;
      align-items: center;
      justify-content: center;
      color: #6370b5;
      font-size: 13px;
      font-weight: 600;
    }

    .avatar img {
      width: 100%;
      height: 100%;
      object-fit: cover;
      display: block;
    }

    .avatar-badge {
      position: absolute;
      bottom: 4px;
      right: 4px;
      width: 22px;
      height: 22px;
      border-radius: 999px;
      background: var(--primary);
      color: white;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 11px;
      font-weight: 600;
      box-shadow: 0 6px 14px rgba(31, 66, 138, 0.4);
    }

    .hero-info h1 {
      margin: 0 0 2px;
      font-size: 20px;
      letter-spacing: 0.02em;
    }

    .hero-info h1 span {
      font-weight: 500;
    }

    .hero-role {
      font-size: 13px;
      font-weight: 600;
      color: var(--primary);
      margin-bottom: 6px;
    }

    .hero-location {
      font-size: 12px;
      color: var(--text-soft);
    }

    .chips-row {
      margin: 14px 0 10px;
      display: flex;
      flex-wrap: wrap;
      gap: 6px;
    }

    .chip {
      border-radius: var(--radius-pill);
      padding: 4px 9px;
      background: var(--chip-bg);
      font-size: 11px;
      color: var(--text-soft);
      display: inline-flex;
      align-items: center;
      gap: 4px;
    }

    .chip-dot {
      width: 6px;
      height: 6px;
      border-radius: 999px;
      background: var(--primary);
    }

    .hero-quote {
      font-size: 12px;
      color: var(--text-soft);
      line-height: 1.4;
      border-left: 2px solid var(--primary-soft);
      padding-left: 10px;
      margin-top: 4px;
    }

    /* Section titre */
    .section-label {
      font-size: 11px;
      letter-spacing: 0.18em;
      text-transform: uppercase;
      color: var(--text-soft);
      margin-bottom: 4px;
    }

    .section-title {
      font-size: 15px;
      font-weight: 650;
      margin-bottom: 10px;
      display: flex;
      align-items: baseline;
      justify-content: space-between;
      gap: 8px;
    }

    .section-title span {
      font-size: 11px;
      text-transform: uppercase;
      color: var(--primary);
      letter-spacing: 0.14em;
    }

    /* Comp√©tences visuelles */
    .skills-grid {
      display: grid;
      grid-template-columns: repeat(2, minmax(0, 1fr));
      gap: 10px;
    }

    .skill-pill {
      border-radius: 16px;
      border: 1px solid var(--border-soft);
      padding: 8px 9px;
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 6px;
      background: rgba(255, 255, 255, 0.8);
    }

    .skill-main {
      display: flex;
      flex-direction: column;
      gap: 1px;
    }

    .skill-name {
      font-size: 12px;
      font-weight: 600;
    }

    .skill-sub {
      font-size: 11px;
      color: var(--text-soft);
    }

    .skill-meter {
      width: 32px;
      height: 32px;
      border-radius: 999px;
      background: conic-gradient(var(--primary) var(--value), #eef1ff var(--value));
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 10px;
      color: var(--text-main);
      font-weight: 600;
    }

    .skill-meter span {
      background: white;
      border-radius: 999px;
      padding: 2px 5px;
      box-shadow: 0 0 0 2px #f3f4ff;
    }

    /* Outils / Langues */
    .mini-list {
      display: flex;
      flex-direction: column;
      gap: 8px;
      margin-top: 8px;
    }

    .mini-row {
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 10px;
      font-size: 12px;
    }

    .mini-label {
      font-weight: 500;
    }

    .bar {
      flex: 1;
      height: 5px;
      border-radius: 999px;
      background: #eceff7;
      overflow: hidden;
      position: relative;
    }

    .bar-fill {
      position: absolute;
      inset: 0;
      border-radius: inherit;
      background: linear-gradient(90deg, var(--primary), #8d9cff);
      transform-origin: left center;
      transform: scaleX(var(--level));
    }

    .lang-note {
      font-size: 11px;
      color: var(--text-soft);
      margin-left: 2px;
    }

    /* Exp√©rience */
    .timeline {
      display: flex;
      flex-direction: column;
      gap: 12px;
      margin-top: 6px;
    }

    .xp-item {
      position: relative;
      padding-left: 16px;
    }

    .xp-item::before {
      content: "";
      position: absolute;
      left: 4px;
      top: 4px;
      width: 7px;
      height: 7px;
      border-radius: 999px;
      background: var(--primary);
    }

    .xp-item::after {
      content: "";
      position: absolute;
      left: 7px;
      top: 14px;
      bottom: -6px;
      width: 1px;
      background: rgba(32, 35, 51, 0.08);
    }

    .xp-item:last-child::after {
      display: none;
    }

    .xp-header {
      display: flex;
      justify-content: space-between;
      align-items: baseline;
      gap: 8px;
      margin-bottom: 2px;
    }

    .xp-role {
      font-size: 13px;
      font-weight: 600;
    }

    .xp-date {
      font-size: 11px;
      color: var(--text-soft);
      white-space: nowrap;
    }

    .xp-company {
      font-size: 11px;
      color: var(--text-soft);
      margin-bottom: 4px;
    }

    .xp-bullets {
      list-style: none;
      padding-left: 0;
      margin: 0;
      font-size: 12px;
      color: var(--text-main);
    }

    .xp-bullets li {
      margin: 2px 0;
    }

    .xp-bullets strong {
      font-weight: 600;
    }

    /* International / Formation */
    .tag-card {
      border-radius: 14px;
      border: 1px solid var(--border-soft);
      padding: 8px 9px;
      font-size: 12px;
      display: flex;
      flex-direction: column;
      gap: 2px;
    }

    .tag-title {
      font-weight: 600;
    }

    .blurred {
      filter: blur(3px);
    }

    .tag-sub {
      font-size: 11px;
      color: var(--text-soft);
    }

    .tag-meta {
      font-size: 11px;
      color: var(--primary);
    }

    .tag-wrapper {
      display: flex;
      flex-direction: column;
      gap: 8px;
      margin-top: 4px;
    }

    /* Footer contacts */
    .contact-row {
      display: flex;
      flex-direction: column;
      gap: 6px;
      font-size: 12px;
      margin-top: 8px;
    }

    .contact-item {
      display: flex;
      align-items: center;
      gap: 8px;
      color: var(--text-soft);
      text-decoration: none;
    }

    .contact-icon {
      width: 22px;
      height: 22px;
      border-radius: 999px;
      background: rgba(60, 111, 209, 0.08);
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 12px;
      color: var(--primary);
    }

    .contact-label {
      font-weight: 500;
      color: var(--text-main);
    }

    .contact-value {
      color: var(--text-soft);
      font-size: 11px;
    }

    a {
      color: inherit;
      text-decoration: none;
    }

    a:active {
      opacity: 0.7;
    }

    /* Petite barre de navigation / indicateur */
    .nav-dots {
      display: flex;
      justify-content: center;
      gap: 4px;
      margin-top: 6px;
    }

    .nav-dot {
      width: 5px;
      height: 5px;
      border-radius: 999px;
      background: #ccd1e5;
    }

    .nav-dot--active {
      width: 16px;
      background: var(--primary);
    }

    @media (min-width: 768px) {
      .app {
        padding-top: 32px;
        padding-bottom: 32px;
      }
    }

    .lightbox {
      position: fixed;
      inset: 0;
      background: black;
      z-index: 9999;
      display: flex;
      justify-content: center;
      align-items: center;
      touch-action: none; /* tr√®s important pour g√©rer nos gestes */
    }

    .hidden {
      display: none;
    }

    .lightbox-close {
      position: absolute;
      top: 16px;
      right: 16px;
      z-index: 10000;
      font-size: 24px;
      color: white;
      cursor: pointer;
    }

    .lightbox-inner {
      width: 100%;
      height: 100%;
      display: flex;
      overflow: hidden;
      scroll-snap-type: x mandatory;
      scroll-behavior: smooth;
      padding: 0 8px;
    }

    .lightbox-slide {
      width: 100%;
      height: 100%;
      flex-shrink: 0;
      display: flex;
      justify-content: center;
      align-items: center;
      padding: 0 8px;
      scroll-snap-align: center;
    }

    .lightbox-slide img,
    .lightbox-slide video {
      max-width: 100%;
      max-height: 100%;
      object-fit: contain;
    }

    .chess-card {
      background-image: url('./cv/images/chess-board.jpg');
      background-size: cover;
      background-position: center;
      position: relative;
    }

    .chess-card::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: rgba(255, 255, 255, 0.9);
      z-index: 0;
    }

    .chess-card > * {
      position: relative;
      z-index: 1;
    }

    



/* ---------------------------------------------------------
   FIX CRITIQUE : permettre la vraie grille 2 colonnes
---------------------------------------------------------*/
@media (min-width: 1024px) {

  /* L'app devient une grille 2 colonnes */
  .app {
    max-width: 1250px;
    display: grid;
    grid-template-columns: 360px 1fr;
    gap: 38px;
    padding: 40px;
    align-items: start;
  }

  /* Le feed ne doit PLUS forcer 1 colonne */
  .feed {
    display: contents; /* cl√© de la r√©ussite */
  }
  /*
   display: contents = les enfants du .feed deviennent enfants directs de la grille .app
   => Permet √† sidebar-card et main-card d'aller dans les bonnes colonnes
  */

  /* Header mobile cach√© sur desktop */
  header.app-header {
    display: none;
  }

  /* Assignation colonne gauche/droite */
  .sidebar-card {
    grid-column: 1;
  }
  .main-card {
    grid-column: 2;
  }
}








/* ==== Download Section (mobile-first) ==== */

.download-card {
  padding: 20px;
  text-align: center;
}

.download-message {
  font-size: 18px;
  font-weight: 700;
  color: var(--primary);
  margin-bottom: 16px;
}

.download-layout {
  display: grid;
  grid-template-columns: 1fr;
  gap: 16px;
  align-items: start;
}

/* Miniature PDF */
.pdf-thumb {
  width: 100%;
  max-width: 260px;
  border-radius: 12px;
  box-shadow: var(--shadow-soft);
  display: block;
  margin: 0 auto;
}

/* QR + bouton */
.dl-right {
  display: flex;
  flex-direction: column;
  gap: 12px;
  align-items: center;
}

.qr-img {
  width: 130px;
  height: 130px;
}

.qr-caption {
  font-size: 12px;
  color: var(--text-soft);
}

/* Bouton */
.download-button {
  display: inline-block;
  background: var(--primary);
  color: #fff !important;
  padding: 12px 18px;
  font-size: 14px;
  border-radius: 14px;
  font-weight: 600;
  text-decoration: none;
}


/* ----- Toast (confirmation de t√©l√©chargement sur mobile & desktop) ----- */
#dl-toast {
  position: fixed;
  left: 50%;
  transform: translateX(-50%);
  bottom: 18px;
  background: #0f172a;
  color: #fff;
  padding: 10px 14px;
  border-radius: 10px;
  font-size: 13px;
  box-shadow: 0 10px 24px rgba(0,0,0,.18);
  z-index: 9999;
  opacity: 0;
  pointer-events: none;
  transition: opacity .2s ease;
}
#dl-toast.show {
  opacity: 1;
}


/* ==== Desktop (‚â•1024px) : 2 colonnes ==== */
@media (min-width: 1024px) {

  .download-card {
    grid-column: 2; /* dans la colonne droite */
    text-align: left;
  }

  .download-layout {
    grid-template-columns: 1fr auto; /* miniature √† gauche, QR+btn √† droite */
    gap: 24px;
  }

  .dl-right {
    align-items: flex-start; /* mettre QR et bouton √† gauche, sinon centr√©s */
  }

  .pdf-thumb {
    max-width: 320px;
  }

  .qr-img {
    width: 150px;
    height: 150px;
  }
}



/* ===== Sticky "empil√©s" dans la sidebar (desktop only) ===== */
@media (min-width: 1024px) {
  /*
    Ajuste ces valeurs si besoin (en px)
    - --sticky-gap : l'espace entre les cartes
    - --hero-top   : marge du hero depuis le haut de la page
    - --hero-h     : hauteur approximative de la carte hero
    - --lang-h     : hauteur approximative de la carte langues
  */
  :root {
    --sticky-gap: 10px;
    --hero-top: 10px;
    --hero-h: 300px;   /* ajuste si ton hero est plus/moins haut */
    --lang-h: 200px;   /* ajuste selon la hauteur de ta carte Langues */
  }
  
  /* Hero: d√©j√† sticky, on s'assure de la valeur */
  .card--hero.sidebar-card {
    position: sticky;
    top: var(--hero-top);
    z-index: 10;
  }

  /* Langues: coll√©e juste sous le Hero */
  .sidebar-card.langues-sticky {
    position: sticky;
    top: calc(var(--hero-top) + var(--hero-h) + var(--sticky-gap));
    z-index: 10;
  }

  /* Contact: coll√©e juste sous Langues */
  .sidebar-card.contact-sticky {
    position: sticky;
    top: calc(
      var(--hero-top) + var(--hero-h) + var(--sticky-gap) +
      var(--lang-h) + var(--sticky-gap)
    );
    z-index: 10;
  }
}




/* ===== Download: centrage parfait et respiration (desktop) ===== */
@media (min-width: 1024px) {

  /* On garde 2 colonnes ; on centre le contenu de chaque colonne */
  .download-card .download-layout {
    grid-template-columns: 1fr auto;
    align-items: center;    /* centre verticalement les deux colonnes entre elles */
    column-gap: 20px;       /* rapproche (tu peux descendre √† 16px) */
    padding-inline: 6px;    /* petit air contre les bords de la card */
  }

  /* Colonne miniature (gauche) : miniature centr√©e dans sa colonne */
  .download-card .dl-left {
    display: flex;
    justify-content: center; /* centre horizontalement la miniature */
    padding-inline: 6px;     /* √©vite l'effet bord */
  }

  /* Colonne droite (QR + bouton) : parfaitement centr√©s l'un sous l'autre */
  .download-card .dl-right {
    display: flex;
    flex-direction: column;
    align-items: center;     /* centre horizontalement QR + bouton dans la colonne */
    gap: 12px;
    padding-inline: 6px;     /* √©vite l'effet bord */
  }

  /* Dimensions harmonieuses pour renforcer le centrage visuel */
  .pdf-thumb {
    max-width: 300px;        /* ajuste si tu veux */
  }
  .qr-img {
    width: 150px;
    height: 150px;
    object-fit: contain;
  }

  /* Bouton "joli" centr√© (il l'est via align-items:center, mais on s√©curise) */
  .download-button {
    text-align: center;
    padding-inline: 20px;
    border-radius: 14px;
    color: #fff !important;
    background: linear-gradient(180deg, color-mix(in srgb, var(--primary) 92%, #ffffff 8%), var(--primary));
    box-shadow: 0 8px 18px rgba(60, 111, 209, .22);
    font-weight: 700;
    transition: transform .06s ease, box-shadow .2s ease, background-color .2s ease;
  }
  .download-button:hover {
    transform: translateY(-1px);
    box-shadow: 0 10px 22px rgba(60, 111, 209, .28);
    background: linear-gradient(180deg, color-mix(in srgb, var(--primary) 96%, #ffffff 4%), var(--primary));
  }
  .download-button:active {
    transform: translateY(0);
    box-shadow: 0 6px 14px rgba(60, 111, 209, .22);
  }
  .download-button:focus-visible {
    outline: 2px solid color-mix(in srgb, var(--primary) 70%, #ffffff 30%);
    outline-offset: 3px;
    box-shadow: 0 0 0 3px rgba(92, 200, 255, .25), 0 8px 18px rgba(60, 111, 209, .22);
  }
}

@media (min-width: 1024px) {
  
.lightbox-inner {
  width: 100%;
  height: 100%;
  display: flex;

  /* autoriser le carrousel horizontal */
  overflow-x: auto;
  overflow-y: hidden;

  scroll-snap-type: x mandatory;
  scroll-behavior: smooth;

  /* IMPORTANT : pas de padding, pour que scrollLeft = index * width soit exact */
  padding: 0;

  -webkit-overflow-scrolling: touch;
  scrollbar-width: none;           /* masque la barre (Firefox) */
}
.lightbox-inner::-webkit-scrollbar { display: none; } /* masque (WebKit) */

/* Confort drag souris */
.lightbox-inner, .lightbox-slide, .lightbox-slide img, .lightbox-slide video {
  user-select: none;
}


.lightbox-inner { cursor: grab; }
.lightbox-inner.dragging { cursor: grabbing; }

.lightbox-inner.dragging .lightbox-slide img,
.lightbox-inner.dragging .lightbox-slide video {
  pointer-events: none;
}

/* Anti-s√©lection pendant le drag (confort) */
.lightbox, .lightbox-inner, .lightbox-slide, .lightbox-slide img, .lightbox-slide video {
  user-select: none;
}

}




/* Conteneur d'action de la hero (inchang√©) */
.hero-actions {
  display: flex;
  justify-content: flex-end;
  margin-top: 6px;
}

/* --- Toggle FR/EN pure CSS --- */
#langToggle {
  /* Dimensions */
  --h: 28px;                 /* hauteur */
  --w: 88px;                 /* largeur un peu plus large pour loger FR | EN */
  --pad: 4px;                /* padding interne de la piste */
  --r: 999px;                /* radius pilule */
  --thumb: calc(var(--h) - var(--pad) * 2); /* diam√®tre pastille */

  /* Couleurs */
  --track-bg: rgba(60,111,209,0.16); /* piste neutre adoucie */
  --thumb-bg: var(--primary);        /* **pastille** = couleur fixe */
  --label: #3c6fd1;         /* texte des extr√©mit√©s */
  --label-active: var(--text-soft);  /* accent l√©ger pour l'√©tat actif */

  position: relative;
  width: var(--w);
  height: var(--h);
  border: 0;
  border-radius: var(--r);
  background: var(--track-bg);       /* piste neutre */
  padding: 0;
  cursor: pointer;
  outline: none;

  /* Si du texte est inject√© par JS, on l'ignore visuellement */
  font-size: 0;
  color: transparent;
  line-height: 0;

  /* Pour √©viter les reflets mobiles */
  -webkit-tap-highlight-color: transparent;
}

/* √âtiquettes FR / EN aux extr√©mit√©s (√† l'int√©rieur de la piste) */
#langToggle::before,
#langToggle::after {
  position: absolute;
  top: 0;
  bottom: 0;
  width: 50%;
  display: flex;
  align-items: center;
  justify-content: center;

  font-size: 11px;      /* visible, car le bouton est en font-size:0 */
  font-weight: 800;
  letter-spacing: .06em;
  color: var(--label);
  pointer-events: none;
  user-select: none;
  line-height: 1;
}

/* FR √† gauche */
#langToggle::before {
  content: "FR";
  left: 0;
}

/* EN √† droite */
#langToggle::after {
  content: "EN";
  right: 0;
}

/* Accent l√©ger sur le label actif via aria-checked */
#langToggle[aria-checked="true"]::before { color: var(--label-active); }
#langToggle[aria-checked="false"]::after { color: var(--label-active); }

/* Pastille (le bouton qui glisse) */
#langToggle .thumb,
#langToggle::marker { /* fallback si jamais un span existait auparavant */
  display: none;
}

/* On dessine la pastille avec un pseudo-√©l√©ment d√©di√© */
#langToggle::marker { content: ""; } /* pour Safari versions tr√®s anciennes (safety) */

#langToggle::selection { background: transparent; } /* hygi√®ne */

#langToggle > i { display: none; } /* si un contenu r√©siduel subsiste, on l'ignore */

/* Pastille en pseudo-√©l√©ment unique */
#langToggle::part(thumb) { display: none; } /* pour √©viter des styles externes */

#langToggle:before.focus-ring { outline: none; } /* hygi√®ne focus */

#langToggle::after:where(.nope) { } /* no-op pour √©viter collisions */

/* LA pastille : on utilise un pseudo-√©l√©ment suppl√©mentaire (.knob) via box-shadow trick */
#langToggle::placeholder { display:none; } /* hygi√®ne */

/* On utilise un autre pseudo : la pastille */
#langToggle::backdrop { display:none; } /* hygi√®ne */

/* Pastille r√©elle : on la met sur un pseudo-√©l√©ment suppl√©mentaire : */
#langToggle::after, /* d√©j√† pris pour EN */
#langToggle::before /* d√©j√† pris pour FR */ {}

/* On cr√©e la pastille avec ::shadow (non standard) -> pas fiable, on va plut√¥t utiliser : */
#langToggle::after-thumb { content: none; } /* no-op */

/* ‚úÖ Pastille via un troisi√®me pseudo : on utilise ::after pour EN et ::before pour FR, 
   donc on ne peut pas. On cr√©e la pastille avec un nouvel √©l√©ment : */
#langToggle::before,
#langToggle::after,
#langToggle::after + ._ { } /* no-op pour hackers */

/* ‚úÖ Solution simple : un pseudo-√©l√©ment SUPPL√âMENTAIRE via ::before ET on d√©place un gradient radial.
   Mais plus robuste : on cr√©e un pseudo-√©l√©ment distinct via : */
#langToggle::part(knob) { display:none; } /* no-op */

/* ‚ûú Finalement, on fait la pastille avec un pseudo unique : ::selection ne convient pas.
   La m√©thode la plus propre : on utilise un troisi√®me layer en ::before/::after ET un pseudo suppl√©mentaire 
   via un √©l√©ment int√©rieur OPTIONNEL. Mais tu ne veux pas de HTML. 
   Donc on va utiliser :after pour pastille et on repositionne les labels avec des spans virtuels dessin√©s via background. */

/* *** Version finale, claire et simple : ***
   - Labels via : 'FR' et 'EN' redessin√©s avec un background text (pas top).
   - Mieux : on garde labels en ::before/::after (d√©j√† fait).
   - Pastille : on la dessine avec un **nouveau pseudo** : on va utiliser **::after** pour EN ? D√©j√† pris.
     => On dessine la pastille avec un **pseudo diff√©rent**: ::before et ::after sont d√©j√† pris.
     => On passe √† **un pseudo de l'√©l√©ment : #langToggle::after** fait EN, #langToggle::before fait FR.
     => On fait la pastille sur **#langToggle::marker** n‚Äôest pas standard partout.
     => OK, on fait la pastille sur **#langToggle::after** ? Non, d√©j√† EN. 
     => On va **garder les labels**, mais les mettre dans un PSEUDO DE LA PISTE via un fond, et lib√©rer ::after pour la pastille.
*/

/* ‚ûú Ajustement : labels "FR" et "EN" via un fond textuel: plus simple:
   On remplace plus haut le contenu : on garde ::before=FR, ::after=EN (c'est tr√®s lisible)
   Et on **dessine la pastille avec un PSEUDO suppl√©mentaire via drop-shadow trick**‚Ä¶ ou on r√©utilise un enfant minimal.
   **Comme tu ne veux pas de JS qui change le contenu, mais le HTML peut rester vide.**
   On va autoriser **un tout petit span** interne pour la pastille, que le JS n‚Äô√©crase pas :
*/

/* Ajoute ce style si tu laisses un <span class="knob"></span> dans le bouton.
   Si tu ne veux vraiment aucun enfant, dis-le et je te renvoie une variante pure pseudo
   en ‚Äúbackground gradient knob‚Äù. */
#langToggle .knob {
  position: absolute;
  top: var(--pad);
  left: var(--pad); /* FR par d√©faut */
  width: var(--thumb);
  height: var(--thumb);
  border-radius: 999px;
  background: var(--thumb-bg);       /* **m√™me couleur tout le temps** */
  box-shadow: 0 6px 18px rgba(60,111,209,.35);
  transition: left .22s ease, transform .22s ease;
  will-change: left, transform;
}

/* EN actif -> pastille √† droite */
#langToggle[aria-checked="false"] .knob {
  left: calc(100% - var(--pad) - var(--thumb));
}

/* Hover / focus */
#langToggle:hover .knob { transform: translateY(-1px); }
#langToggle:focus-visible {
  outline: 2px solid color-mix(in srgb, var(--primary) 70%, #ffffff 30%);
  outline-offset: 3px;
}




  </style>
</head>
<body>
  <div class="app">
    <header class="app-header">
      <div class="logo-text">CV &middot; NICOLAS PARISSE</div>
      <div class="tag-pill">QA Automation &middot; Cypress ¬∑ API</div>
    </header>

    <main class="feed">
      <!-- HERO / PROFIL -->
      <section class="card card--hero sidebar-card">
        <div class="card-inner">
          <div class="hero-header">
            <div class="avatar">
              <!-- Remplace src par ton vrai chemin d'image -->
              <img src="cv/images/photo2.png" alt="Photo de Nicolas Parisse" />
              <div class="avatar-badge">32</div>
            </div>
            <div class="hero-info">
              <h1 data-i18n="hero.firstname">Nicolas <span>Parisse</span></h1>
              <div class="hero-role">QA Automation Engineer</div>
              <div class="hero-location">Paris, √éle-de-France, France</div>
              <div class="hero-actions">
                <button id="langToggle" role="switch" class="lang-toggle" type="button" aria-label="Switch language"><span class="thumb" aria-hidden="true"></span></button>
              </div>
            </div>
          </div>

          <div class="chips-row">
            <div class="chip"><span class="chip-dot"></span>Cypress</div>
            <div class="chip"><span class="chip-dot"></span>Tests API &ndash; Bruno</div>
            <div class="chip"><span class="chip-dot"></span>CI/CD Azure DevOps</div>
            <div class="chip"><span class="chip-dot"></span>Angular &middot; .NET Core</div>
            <div class="chip"><span class="chip-dot"></span>Bash &amp; PowerShell</div>
          </div>

          <p class="hero-quote" data-i18n="hero.quote">
            Automatiser intelligemment, c‚Äôest assurer la qualit√© des proc√©d√©s critiques.<br />
            Ing√©nieur QA Automation sp√©cialis√© en Cypress, tests API et int√©gration CI/CD,
            avec exp√©rience sur projets √† forte volum√©trie et internationaux
            (parcours critiques E2E, API, s√©curit√© applicative, CI/CD int√©gr√©e).
          </p>
        </div>
      </section>

      <!-- COMP√âTENCES -->
      <section class="card main-card">
        <div class="card-inner">
          <div class="section-label">Comp√©tences cl√©s</div>
          <div class="section-title">
            QA Automation
            <span>cypress &amp; api testing</span>
          </div>

          <div class="skills-grid">
            <div class="skill-pill" style="--value: 0.90turn;">
              <div class="skill-main">
                <div class="skill-name">Cypress</div>
                <div class="skill-sub">UI / Component / E2E</div>
              </div>
              <div class="skill-meter"><span>90</span></div>
            </div>

            <div class="skill-pill" style="--value: 0.95turn;">
              <div class="skill-main">
                <div class="skill-name">Bruno</div>
                <div class="skill-sub">Tests API</div>
              </div>
              <div class="skill-meter"><span>95</span></div>
            </div>

            <div class="skill-pill" style="--value: 0.80turn;">
              <div class="skill-main">
                <div class="skill-name">CI/CD</div>
                <div class="skill-sub">Azure DevOps</div>
              </div>
              <div class="skill-meter"><span>80</span></div>
            </div>

            <div class="skill-pill" style="--value: 0.75turn;">
              <div class="skill-main">
                <div class="skill-name">Frontend</div>
                <div class="skill-sub">Angular</div>
              </div>
              <div class="skill-meter"><span>75</span></div>
            </div>

            <div class="skill-pill" style="--value: 0.75turn;">
              <div class="skill-main">
                <div class="skill-name">Backend</div>
                <div class="skill-sub">.NET Core</div>
              </div>
              <div class="skill-meter"><span>75</span></div>
            </div>

            <div class="skill-pill" style="--value: 0.85turn;">
              <div class="skill-main">
                <div class="skill-name">Scripting</div>
                <div class="skill-sub">Bash / PowerShell</div>
              </div>
              <div class="skill-meter"><span>85</span></div>
            </div>
          </div>

          <div class="section-label" style="margin-top: 14px;">Outils &amp; m√©thodes</div>
          <div class="mini-list">
            <div class="mini-row">
              <div class="mini-label">Git</div>
              <div class="bar" style="--level: 1;">
                <div class="bar-fill"></div>
              </div>
            </div>
            <div class="mini-row">
              <div class="mini-label">S√©curit√© (SAST, SCA, IaC)</div>
              <div class="bar" style="--level: 0.81;">
                <div class="bar-fill"></div>
              </div>
            </div>
            <div class="mini-row">
              <div class="mini-label">Agile (Epic, US, Sprint)</div>
              <div class="bar" style="--level: 0.68;">
                <div class="bar-fill"></div>
              </div>
            </div>
            <div class="mini-row">
              <div class="mini-label">IA (Copilot)</div>
              <div class="bar" style="--level: 1;">
                <div class="bar-fill"></div>
              </div>
            </div>
            <div class="mini-row">
              <div class="mini-label">ISTQB</div>
              <div class="bar" style="--level: 0.85;">
                <div class="bar-fill"></div>
              </div>
            </div>
          </div>
        </div>
      </section>

      <!-- LANGUES -->
      <section class="card sidebar-card langues-sticky">
        <div class="card-inner">
          <div class="section-label">Langues</div>
          <div class="section-title">
            Communication
            <span>fr / en</span>
          </div>

          <div class="mini-list">
            <div class="mini-row">
              <div>
                <div class="mini-label">Fran√ßais</div>
                <div class="lang-note">C2 &ndash; langue maternelle</div>
              </div>
              <div class="bar" style="--level: 1;">
                <div class="bar-fill"></div>
              </div>
            </div>

            <div class="mini-row">
              <div>
                <div class="mini-label">Anglais</div>
                <div class="lang-note">C1</div>
              </div>
              <div class="bar" style="--level: 0.8;">
                <div class="bar-fill"></div>
              </div>
            </div>
          </div>
        </div>
      </section>

      <!-- EXP√âRIENCE -->
      <section class="card main-card">
        <div class="card-inner">
          <div class="section-label">Exp√©rience</div>
          <div class="section-title">
            Coexya
            <span>paris</span>
          </div>

          <div class="timeline">
            <div class="xp-item">
              <div class="xp-header">
                <div class="xp-role">Ing√©nieur Concepteur &ndash; QA Automation</div>
                <div class="xp-date">2022 &ndash; Pr√©sent</div>
              </div>
              <!-- <div class="xp-company">Coexya ¬∑ Paris</div> -->
              <ul class="xp-bullets">
                <li>Mise en place <strong>from scratch</strong> de la strat√©gie QA</li>
                <li>Un projet r√©unissant <strong>20+ collaborateurs</strong>.</li>
                <li>D√©veloppement de <strong>200+ tests composants (UI)</strong> pour s√©curiser les modules critiques. 
                <li>Planification de <strong>10 parcours E2E</strong> couvrant les sc√©narios m√©tier majeurs.</li>
                <li>Automatisation de <strong>600+ requ√™tes API</strong> d√©di√©es √† la robustesse des services.</li>
                <li>Int√©gration compl√®te en <strong>CI/CD</strong> via Azure DevOps.</li>
                <li>Int√©gration dans la <strong>CI/CD Azure DevOps</strong> (ex√©cution, reporting, gating qualit√©).</li>
                <li>Prise en charge de la <strong>s√©curit√© applicative (CxOne)</strong>.</li>
                <li>S√©curit√© applicative : int√©gration de <strong>scans de vuln√©rabilit√©s</strong> (CheckmarxOne) dans les pipelines.</li>
              </ul>
            </div>

            <div class="xp-item">
              <div class="xp-header">
                <div class="xp-role">Analyste Ing√©nieur</div>
                <div class="xp-date">2020 &ndash; 2022</div>
              </div>
              <!-- <div class="xp-company">Coexya ¬∑ Paris</div> -->
              <ul class="xp-bullets">
                <li>Analyse des besoins, estimation du workload, revue de code.</li>
                <li>Responsable de la <strong>s√©curit√© web</strong>.</li>
              </ul>
            </div>

            <div class="xp-item">
              <div class="xp-header">
                <div class="xp-role">Ing√©nieur d&apos;√©tudes</div>
                <div class="xp-date">2018 &ndash; 2020</div>
              </div>
              <!-- <div class="xp-company">Coexya ¬∑ Paris</div> -->
              <ul class="xp-bullets">
                <li>D√©veloppeur <strong>full stack</strong> (.NET Framework, SQL, applications web).</li>
              </ul>
            </div>
          </div>
        </div>
      </section>

      <!-- INTERNATIONAL & FORMATION -->
      <section class="card main-card">
        <div class="card-inner">
          <div class="section-label">International &amp; formation</div>
          <div class="section-title">
            Parcours
            <span>nz &middot; irlande &middot; from Paris</span>
          </div>

          <div class="tag-wrapper">
            <div class="tag-card">
              <div class="tag-title"><span class="blurred">welltried</span></div>
              <div class="tag-sub">Projet SaaS avec technos r√©centes from scratch &ndash; Automatisation des tests</div>
              <div class="tag-meta">En d√©veloppement</div>
            </div>
            <div class="tag-card">
              <div class="tag-title">IPONZ</div>
              <div class="tag-sub">Gouvernement de Nouvelle-Z√©lande &ndash; Website propri√©t√© intellectuelle</div>
              <div class="tag-meta">Projet √† fort volum√©trie</div>
            </div>

            <div class="tag-card">
              <div class="tag-title">RESOLVE</div>
              <div class="tag-sub">Minist√®re de la Justice &ndash; Nouvelle-Z√©lande &ndash; Gestion des plaintes</div>
              <div class="tag-meta">Website m√©tier &ndash; flux critiques</div>
            </div>

            <div class="tag-card">
              <div class="tag-title">IPO</div>
              <div class="tag-sub">Gouvernement d&apos;Irlande &ndash; Website propri√©t√© intellectuelle</div>
              <div class="tag-meta">Qualit√© et continuit√© de service</div>
            </div>
          </div>

          <div class="section-label" style="margin-top: 14px;">Formation</div>
          <div class="tag-wrapper">
            <div class="tag-card">
              <div class="tag-title">Dipl√¥me d&apos;ing√©nieur</div>
              <div class="tag-sub">Institut d&apos;Optique Graduate School</div>
              <div class="tag-meta">2018</div>
            </div>

            <div class="tag-card">
              <div class="tag-title">Master Informatique</div>
              <div class="tag-sub">Universit√© de Bordeaux</div>
              <div class="tag-meta">2018</div>
            </div>
          </div>
        </div>
      </section>

      <!-- HOBBIES -->
      <section class="card main-card">
        <div class="card-inner">
          <div class="section-label">Hobbies</div>
          <div class="section-title">
            Centres d‚Äôint√©r√™t
            <span>perso</span>
          </div>

          <div class="tag-wrapper">

            <!-- Escalade -->
            <div class="tag-card">
              <div class="tag-title">Escalade</div>
              <div class="tag-sub">Bleau, grandes voies, difficult√©. Objectif 8a !</div>

              <!-- Vid√©o escalade -->
              <video  
                muted 
                playsinline 
                preload="metadata" 
                onclick="openLightbox(['cv/escalade.mp4'], 0)"
                style="width:50%; aspect-ratio: 1; display: block; margin: 8px auto 0; border-radius:14px; object-fit: cover;">
                <source src="cv/escalade.mp4" type="video/mp4">
              </video>

              <div class="tag-meta" style="text-align: center;">Crotale 7a - Fontainebleau</div>
            </div>

            <!-- √âchecs -->
            <div class="tag-card chess-card">
              <div class="tag-title">√âchecs</div>
              <div class="tag-sub">
                Classement Lichess : 1700+
              </div>
              <div class="tag-meta">
                <a href="javascript:void(0);" onclick="createLichessChallengeLink()">
                  Me d√©fier sur Lichess
                </a>
              </div>
            </div>


            <!-- Road trip -->
            <div class="tag-card">
              <div class="tag-title">Voyage</div>
              <div class="tag-sub">Europe</div>

              <div style="display:flex; gap:8px; overflow-x:auto; padding:4px 0;">
                <img src="cv/roadtrip/vernazza.jpg" 
                    alt="Vernazza" 
                    onclick="openLightbox(['cv/roadtrip/vernazza.jpg','cv/roadtrip/Terrasse.jpg','cv/roadtrip/Nicolas et met.jpg', 'cv/roadtrip/porto.jpg', 'cv/roadtrip/grandeVoie.jpg'], 0)"
                    style="height:120px; border-radius:12px; flex-shrink:0;">
                <img src="cv/roadtrip/Terrasse.jpg" 
                    alt="Terrasse" 
                    onclick="openLightbox(['cv/roadtrip/vernazza.jpg','cv/roadtrip/Terrasse.jpg','cv/roadtrip/Nicolas et met.jpg', 'cv/roadtrip/porto.jpg', 'cv/roadtrip/grandeVoie.jpg'], 1)"
                    style="height:120px; border-radius:12px; flex-shrink:0;">
                <img src="cv/roadtrip/Nicolas et met.jpg" 
                    alt="Nicolas et met" 
                    onclick="openLightbox(['cv/roadtrip/vernazza.jpg','cv/roadtrip/Terrasse.jpg','cv/roadtrip/Nicolas et met.jpg', 'cv/roadtrip/porto.jpg', 'cv/roadtrip/grandeVoie.jpg'], 2)"
                    style="height:120px; border-radius:12px; flex-shrink:0;">
                <img src="cv/roadtrip/porto.jpg" 
                    alt="Terrasse" 
                    onclick="openLightbox(['cv/roadtrip/vernazza.jpg','cv/roadtrip/Terrasse.jpg','cv/roadtrip/Nicolas et met.jpg', 'cv/roadtrip/porto.jpg', 'cv/roadtrip/grandeVoie.jpg'], 3)"
                    style="height:120px; border-radius:12px; flex-shrink:0;">
                <img src="cv/roadtrip/grandeVoie.jpg" 
                    alt="Terrasse" 
                    onclick="openLightbox(['cv/roadtrip/vernazza.jpg','cv/roadtrip/Terrasse.jpg','cv/roadtrip/Nicolas et met.jpg', 'cv/roadtrip/porto.jpg', 'cv/roadtrip/grandeVoie.jpg'], 4)"
                    style="height:120px; border-radius:12px; flex-shrink:0;">
              </div>

              <div class="tag-meta">Europe</div>
            </div>


          </div>
        </div>
      </section>


      <!-- CONTACT -->
      <section class="card sidebar-card contact-sticky">
        <div class="card-inner">
          <div class="section-label">Contact</div>
          <div class="section-title">
            Me joindre
            <span>disponible pour √©change</span>
          </div>

          <div class="contact-row">
            <a class="contact-item" href="mailto:nicolas.parisse.93@gmail.com">
              <div class="contact-icon">@</div>
              <div>
                <div class="contact-label">Email</div>
                <div class="contact-value">nicolas.parisse.93@gmail.com</div>
              </div>
            </a>

            <a class="contact-item" href="tel:+33685743744">
              <div class="contact-icon">üìû</div>
              <div>
                <div class="contact-label">T√©l√©phone</div>
                <div class="contact-value">06 85 74 37 44</div>
              </div>
            </a>

            <a class="contact-item" href="https://www.linkedin.com/in/nicolas-parisse-034b70b9/" target="_blank" rel="noopener noreferrer">
              <div class="contact-icon">in</div>
              <div>
                <div class="contact-label">LinkedIn</div>
                <div class="contact-value">linkedin.com/in/nicolas-parisse</div>
              </div>
            </a>

            <a class="contact-item" href="https://www.google.com/maps?q=Paris+12e" target="_blank" rel="noopener noreferrer">
              <div class="contact-icon">üìç</div>
              <div>
                <div class="contact-label">Localisation</div>
                <div class="contact-value">Paris 12e</div>
              </div>
            </a>
          </div>

          <!-- <div class="nav-dots">
            <div class="nav-dot nav-dot--active"></div>
            <div class="nav-dot"></div>
            <div class="nav-dot"></div>
          </div> -->
        </div>
      </section>

       


<section class="card main-card download-card">
  <div class="card-inner">

    <div class="section-label">T√©l√©chargement</div>
    <div class="section-title">
            Version classique
            <span>PDF</span>
          </div>
    <div class="download-layout">

      <!-- Gauche : miniature du PDF -->
      <div class="dl-left">
        <img src="cv/images/preview.png" 
             alt="Aper√ßu du CV PDF" 
             class="pdf-thumb"/>
      </div>

      <!-- Droite : QR + bouton -->
      <div class="dl-right">
        <a href="cv/CV_Nicolas_Parisse.pdf"
           download
           class="download-button" onclick="cvDownloadedNotification()">
          üìÑ T√©l√©charger le CV
        </a>

      </div>
    </div>

  </div>
</section>




    </main>
  </div>

  <div id="lightbox" class="lightbox hidden">
    <div class="lightbox-close" onclick="closeLightbox()">‚úï</div>
    <div class="lightbox-inner" id="lightboxInner" tabindex="0">
      <!-- Le m√©dia actif sera inject√© ici -->
    </div>
  </div>
  <div id="dl-toast" role="status" aria-live="polite">T√©l√©chargement lanc√©‚Ä¶</div>

  <script>
    let lightbox = document.getElementById("lightbox");
    let lightboxInner = document.getElementById("lightboxInner");

    let currentMediaList = [];
    let currentIndex = 0;
    
const COMMIT_PX = 60;    // seuil "fixe" en pixels pour valider l'intention
const COMMIT_RATIO = 0.12; // ou 12% de la largeur du viewport (√† toi d'ajuster)

    let startX = 0;
    let startY = 0;
    let isDragging = false;

    const SWIPE_THRESHOLD = 60; // pixels

    
function renderAllMedia() {
  lightboxInner.innerHTML = "";

  // 1) cr√©er les slides
  currentMediaList.forEach((src, index) => {
    const slide = document.createElement("div");
    slide.className = "lightbox-slide";

    if (src.endsWith(".mp4")) {
      const video = document.createElement("video");
      video.src = src;
      video.controls = true;
      video.muted = true;
      video.playsInline = true;
      video.autoplay = index === currentIndex;
      slide.appendChild(video);
      // quand la metadata est pr√™te, on recale (utile si la taille influe)
      video.addEventListener("loadedmetadata", () => {
        if (index === currentIndex && !isDragging) updateSliderPosition();
      });
    } else {
      const img = document.createElement("img");
      img.src = src;
      // idem : recalage quand l'image est pr√™te
      img.addEventListener("load", () => {
        if (index === currentIndex && !isDragging) updateSliderPosition();
      });
      slide.appendChild(img);
    }

    lightboxInner.appendChild(slide);
  });

  // 2) premier calage imm√©diatement apr√®s insertion
  updateSliderPosition();

  // 3) second calage au frame suivant (apr√®s paint)
  requestAnimationFrame(() => updateSliderPosition());

  // 4) dernier filet de s√©curit√© (apr√®s que le layout se stabilise)
  setTimeout(updateSliderPosition, 120);
}

    
    function updateSliderPosition() {
      const slideWidth = lightboxInner.clientWidth; // chaque .lightbox-slide = width:100%
      lightboxInner.scrollLeft = currentIndex * slideWidth;
}

    function openLightbox(mediaList, index = 0) {
      currentMediaList = mediaList;
      currentIndex = index;
      renderAllMedia();
      lightbox.classList.remove("hidden");
    }

    function closeLightbox() {
      lightbox.classList.add("hidden");
      lightboxInner.innerHTML = "";
    }

    // Gestes tactiles : gauche/droite = suivant/pr√©c√©dent, bas = fermer
    lightbox.addEventListener("touchstart", function (e) {
      const touch = e.touches[0];
      startX = touch.clientX;
      startY = touch.clientY;
      isDragging = true;
    }, { passive: true });

    lightbox.addEventListener("touchmove", function (e) {
      if (!isDragging) return;
      const touch = e.touches[0];
      const dx = touch.clientX - startX;
      
      const slideWidth = lightboxInner.offsetWidth;
      const scrollPos = (currentIndex * slideWidth) - dx;
      lightboxInner.scrollLeft = scrollPos;
    }, { passive: true });

    lightbox.addEventListener("touchend", function (e) {
      if (!isDragging) return;
      isDragging = false;

      const touch = e.changedTouches[0];
      const dx = touch.clientX - startX;
      const dy = touch.clientY - startY;

      if (Math.abs(dx) > Math.abs(dy)) {
        if (dx < -SWIPE_THRESHOLD && currentIndex < currentMediaList.length - 1) {
          currentIndex++;
        } else if (dx > SWIPE_THRESHOLD && currentIndex > 0) {
          currentIndex--;
        }
      }
      
      updateSliderPosition();
    }, { passive: true });
  
    

  </script>


<script>
(() => {
  if (document.readyState === 'loading') {
    document.addEventListener('DOMContentLoaded', initMouseDragPointer);
  } else {
    initMouseDragPointer();
  }

  
// Seuils d'intention (tu peux ajuster)
const COMMIT_PX = 60;        // px mini
const COMMIT_RATIO = 0.12;   // ou 12% de la largeur

function computeIntentionTargetIndex(dx) {
  const inner = document.getElementById('lightboxInner');
  const width = inner.clientWidth;
  const threshold = Math.min(COMMIT_PX, width * COMMIT_RATIO);

  let targetIndex = currentIndex; // par d√©faut on reste
  if (dx <= -threshold && currentIndex < currentMediaList.length - 1) {
    targetIndex = currentIndex + 1; // glisser vers la gauche
  } else if (dx >= threshold && currentIndex > 0) {
    targetIndex = currentIndex - 1; // glisser vers la droite
  }

  return targetIndex;
}

// (Optionnel) si tu veux garder une API "snapToIntention" pour desktop :
function snapToIntentionDesktop(dx) {
  const targetIndex = computeIntentionTargetIndex(dx);
  currentIndex = targetIndex;
  scrollToIndexDesktop(targetIndex, { duration: 260 });
}

  function initMouseDragPointer() {
    const inner = document.getElementById('lightboxInner');
    if (!inner) return;

    if (!inner.hasAttribute('tabindex')) inner.setAttribute('tabindex', '0');
    inner.addEventListener('dragstart', (e) => e.preventDefault());

    let dragging = false;
    let intented = false;
    let startX = 0;
    let startScrollLeft = 0;
    const INTENT_PX = 6;

    
function setDragging(on) {
  inner.classList.toggle('dragging', !!on);
  if (on) {
    // Pendant le drag desktop
    isDragging = true;                  // <- flag commun (mobile non impact√©)
    inner.style.scrollBehavior = 'auto';
    inner.style.scrollSnapType = 'none'; // <- on coupe le snap ici
    document.body.style.cursor = 'grabbing';
  } else {
    // Fin de drag desktop
    isDragging = false;                 // <- il faut le mettre √† false AVANT l'anim
    inner.style.scrollBehavior = '';
    // ‚ö†Ô∏è NE PAS restaurer scrollSnapType ici, l‚Äôanimateur s‚Äôen charge.
    document.body.style.cursor = '';
  }
}
    // PointerDown : souris uniquement
    inner.addEventListener('pointerdown', (e) => {
      if (e.pointerType !== 'mouse' || e.button !== 0) return;

      // √âviter √©l√©ments interactifs (liens/inputs/contr√¥les vid√©o)
      const interactive = e.target.closest('a, button, input, textarea, select, summary, label, video');
      if (interactive) return;

      dragging = true;
      intented = false;
      startX = e.clientX;
      startScrollLeft = inner.scrollLeft;

      // capture : garantit la r√©ception des events jusqu'au pointerup
      inner.setPointerCapture(e.pointerId);
      setDragging(true);

      e.preventDefault();
    });

    // PointerMove : souris uniquement
    inner.addEventListener('pointermove', (e) => {
      if (!dragging || e.pointerType !== 'mouse') return;

      const dx = e.clientX - startX;

      if (!intented && Math.abs(dx) >= INTENT_PX) {
        intented = true;
      }

      if (intented) {
        inner.scrollLeft = startScrollLeft - dx;
        // LOG('scrollLeft', inner.scrollLeft); // d√©commente si besoin
      }
    }, { passive: true });

    // Fin du drag (pointerup/cancel)
    const end = (e) => {
      if (!dragging) return;
      dragging = false;

      // rel√¢cher la capture si active
      try { if (e && e.pointerId != null) inner.releasePointerCapture(e.pointerId); } catch {}

      setDragging(false);

      if (!intented) {
        return;
      }      

const dx = (e && e.clientX != null) ? (e.clientX - startX) : 0;
const targetIndex = computeIntentionTargetIndex(dx);
currentIndex = targetIndex;
// üîî Animation desktop : depuis la position ACTUELLE -> slide cible
scrollToIndexDesktop(targetIndex, { duration: 260 });

    };

    inner.addEventListener('pointerup', end);
    inner.addEventListener('pointercancel', end);

    
function snapToIntention(dx) {
  const width = inner.clientWidth;
  const threshold = Math.min(COMMIT_PX, width * COMMIT_RATIO);

  let targetIndex = currentIndex; // par d√©faut, on reste

  if (dx <= -threshold && currentIndex < currentMediaList.length - 1) {
    // gliss√© vers la gauche -> slide suivante
    targetIndex = currentIndex + 1;
  } else if (dx >= threshold && currentIndex > 0) {
    // gliss√© vers la droite -> slide pr√©c√©dente
    targetIndex = currentIndex - 1;
  }

  currentIndex = targetIndex;
  updateSliderPosition(); // recentre proprement sur la slide choisie
}
    // Snap sym√©trique (pas d‚Äôinertie pour stabilit√©)
    function snapToNearestSymmetric() {
      const width = inner.clientWidth;
      let targetIndex = Math.round(inner.scrollLeft / width);
      targetIndex = Math.max(0, Math.min(currentMediaList.length - 1, targetIndex));
      currentIndex = targetIndex;
      updateSliderPosition(); // recentre proprement
    }
  }
})();
</script>

<script>

// Easing confort
function easeOutCubic(t) {
  return 1 - Math.pow(1 - t, 3);
}

/**
 * Animation DESKTOP uniquement : part depuis scrollLeft ACTUEL -> index cible.
 * - Le mobile ne passe pas ici (appel√© seulement depuis la souris).
 * - Le scroll-snap reste coup√© pendant l'anim.
 */
function scrollToIndexDesktop(targetIndex, {
  duration = 280,
  easing = easeOutCubic,
  log = false
} = {}) {
  const inner = document.getElementById('lightboxInner');
  if (!inner) return;

  const width = inner.clientWidth;
  const start = inner.scrollLeft;              // <-- position ACTUELLE
  const end   = Math.round(targetIndex * width);
  const delta = end - start;

  if (Math.abs(delta) < 1) {
    inner.scrollLeft = end;
    return;
  }

  // Laisser l‚Äôanimateur ma√Ætriser le snap (ne pas le r√©activer trop t√¥t)
  const prevSnap = inner.style.scrollSnapType;
  const prevBehavior = inner.style.scrollBehavior;

  inner.style.scrollSnapType = 'none';  // <-- on s'assure que c'est bien coup√©
  inner.style.scrollBehavior = 'auto';

  const t0 = performance.now();
  let rafId = null;

  function cleanup() {
    if (rafId) cancelAnimationFrame(rafId);
    inner.style.scrollSnapType = prevSnap || '';     // <-- restaur√© uniquement ici
    inner.style.scrollBehavior = prevBehavior || '';
  }

  function step(now) {
    // Si l'utilisateur relance un drag (desktop), on stoppe l'anim
    if (isDragging) { cleanup(); return; }    // <-- utilise le bon flag

    const t = Math.min(1, (now - t0) / duration);
    const p = easing(t);
    inner.scrollLeft = start + delta * p;

    if (t < 1) {
      rafId = requestAnimationFrame(step);
    } else {
      inner.scrollLeft = end; // verrouille exactement
      cleanup();
    }
  }

  rafId = requestAnimationFrame(step);
}

</script>



<script>

  // --- Clavier: fl√®ches gauche/droite ---
  lightbox.addEventListener('keydown', (e) => {
    if (e.key === 'ArrowRight' && currentIndex < currentMediaList.length - 1) {
      currentIndex++;
      updateSliderPosition();
      e.preventDefault();
    }
    if (e.key === 'ArrowLeft' && currentIndex > 0) {
      currentIndex--;
      updateSliderPosition();
      e.preventDefault();
    }
    if (e.key === 'Escape') {
      closeLightbox();
      e.preventDefault();
    }
  });

  // Donne le focus √† l'ouverture pour capter le clavier
  const _openLightboxOriginal = openLightbox;
  openLightbox = function(mediaList, index = 0) {
    _openLightboxOriginal(mediaList, index);
    // Focus apr√®s affichage
    setTimeout(() => lightboxInner.focus(), 0);
  };
</script>

  <script src="./js/sendNotification.js"></script>
  <script src="./js/challenge.js"></script>
  <script src="./js/visitor-tracking.js"></script>
  <script src="./js/i18n.js"></script>
  <script src="./js/download.js"></script>


</body>
</html>
